# 快速入门指南 - 5分钟上手

## 🎯 您是管理员？

### 第一次使用 - 3步完成配置

**1. 安装Python依赖**
```bash
cd tools
pip install -r requirements.txt
```

**2. 加密您的EXE程序**
```bash
python encrypt_exe.py
# 输入您的EXE文件路径，如: C:\MyProgram.exe
# 会生成: MyProgram_encrypted.dat 和 MyProgram_master.key
```

**3. 生成用户密钥**
```bash
python generate_keys.py
# 选择主密钥文件: MyProgram_master.key
# 选择选项1，输入用户信息生成密钥
```

### 分发给用户

**1. 上传加密文件到云盘**
- 上传 `MyProgram_encrypted.dat` 到阿里云OSS/蓝奏云/百度网盘
- 获取直链地址

**2. 配置下载脚本**
- 编辑 `dist/download.bat`
- 修改第17行: `set "DOWNLOAD_URL=您的云盘直链"`

**3. 编译启动器(仅需一次)**
```bash
cd dist
pip install pyinstaller
pyinstaller --onefile --windowed --name=launcher launcher.py
# launcher.exe 会生成在 dist/dist/ 目录
```

**4. 打包给用户**
打包这3个文件:
- download.bat
- launcher.exe
- 使用说明.txt

**5. 发送密钥**
将生成的64位密钥发送给对应用户

✅ 完成！

---

## 👤 您是用户？

### 2步开始使用

**第1步: 下载程序**
1. 双击 `download.bat`
2. 等待下载完成
3. 选择 Y 立即启动

**第2步: 输入密钥**
1. 在弹出窗口输入管理员提供的64位密钥
2. 点击"验证并启动"
3. 程序自动运行

✅ 完成！

---

## 📋 文件说明

### 管理员工具 (tools/)
- `encrypt_exe.py` - 加密EXE文件
- `generate_keys.py` - 生成用户密钥
- `requirements.txt` - Python依赖

### 用户文件 (dist/)
- `download.bat` - 下载脚本
- `launcher.exe` - 启动器
- `使用说明.txt` - 用户指南

---

## ❓ 常见问题

**Q: 没有Python环境怎么办？**
- 访问 https://www.python.org/downloads/
- 下载并安装Python 3.8+
- 安装时勾选"Add Python to PATH"

**Q: 云盘选择哪个？**
- 推荐: 阿里云OSS (稳定、快速、可控)
- 备选: 蓝奏云 (免费、有直链)
- 备选: 百度网盘 (需转换直链)

**Q: 密钥可以重复使用吗？**
- 可以！一个密钥可以多次使用
- 但建议每个用户独立密钥

**Q: 如何撤销某个用户的访问？**
- 方案1: 更换加密文件和云盘链接
- 方案2: 在launcher.py中添加在线验证

**Q: 编译launcher失败？**
- 确保安装了: `pip install pyinstaller pycryptodome`
- Windows需要: Visual C++ 运行库

---

## 🔐 安全提醒

### 管理员
- ⚠️ **妥善保管主密钥文件** (.key文件)
- ⚠️ 定期备份 user_keys.json
- ⚠️ 不要将主密钥上传到云端

### 用户
- ⚠️ 不要分享您的密钥
- ⚠️ 如密钥泄露请联系管理员

---

## 📞 获取帮助

详细文档: `README.md`
完整演示: 运行 `python DEMO.py`

---

**版本:** v1.0
**更新:** 2025-12-25
