# EXE加密分发系统 - 项目概览

本项目提供完整的EXE文件加密分发解决方案，支持一人一码、云盘下载、时效性验证。

---

## 🎯 核心功能

### ✅ 基础功能（V1 + V2 共有）
- **一人一码机制** - 每个用户独立的64位加密密钥
- **AES-256加密** - 军事级加密强度保护EXE文件
- **云盘直链下载** - 支持阿里云OSS/蓝奏云/百度网盘
- **BAT自动下载** - 双击即可自动下载加密文件
- **本地密钥验证** - 无需联网，保护用户隐私
- **图形化启动器** - 友好的GUI界面

### ⭐ V2 新增功能（时效性验证）
- **灵活有效期** - 1天/7天/30天/90天/365天/永久/自定义
- **首次激活机制** - 从用户首次使用开始计时
- **过期自动检测** - 密钥过期后自动拒绝启动
- **剩余天数显示** - 实时显示密钥剩余有效期
- **智能续费提醒** - 有效期≤7天自动提醒
- **密钥续期功能** - 支持延长有效期

---

## 📦 项目结构

```
Release/
├── tools/                          # 管理员工具
│   ├── encrypt_exe.py             # EXE文件加密工具
│   ├── generate_keys.py           # V1密钥生成器（永久）
│   ├── generate_keys_v2.py        # V2密钥生成器（时效性）⭐
│   └── requirements.txt           # Python依赖
│
├── dist/                          # 用户分发文件
│   ├── download.bat              # 自动下载脚本
│   ├── launcher.py               # V1启动器源码
│   ├── launcher_v2.py            # V2启动器源码 ⭐
│   ├── build_launcher.txt        # 编译说明
│   └── 使用说明.txt               # 用户指南
│
├── README.md                     # 完整技术文档
├── 快速入门.md                    # 5分钟快速上手
├── 时效性验证说明.md               # V2详细文档 ⭐
├── 版本选择指南.md                 # V1/V2对比 ⭐
├── 项目概览.md                    # 本文档
├── DEMO.py                       # V1功能演示
└── DEMO_V2.py                    # V2功能演示 ⭐
```

---

## 🆚 版本对比

| 特性 | V1 (基础版) | V2 (时效性版) |
|------|------------|--------------|
| **密钥验证** | ✅ | ✅ |
| **AES-256加密** | ✅ | ✅ |
| **一人一码** | ✅ | ✅ |
| **云盘下载** | ✅ | ✅ |
| **本地验证** | ✅ | ✅ |
| **时效性验证** | ❌ | ✅ |
| **首次激活** | ❌ | ✅ |
| **过期检测** | ❌ | ✅ |
| **剩余天数** | ❌ | ✅ |
| **续费提醒** | ❌ | ✅ |
| **密钥续期** | ❌ | ✅ |
| **适用场景** | 永久授权 | 订阅制/试用 |
| **商业模式** | 买断制 | SaaS订阅 |

---

## 💡 版本选择建议

### 选择 V1（基础版）适合：
- ✅ 永久授权模式
- ✅ 买断制商业软件
- ✅ 企业内部工具
- ✅ 不需要管理有效期

### 选择 V2（时效性版）适合：
- ✅ SaaS订阅软件
- ✅ 试用版控制
- ✅ 月卡/年卡模式
- ✅ 在线教育课程
- ✅ 游戏会员系统
- ✅ 需要持续收入

### 混合使用：
- VIP用户 → V1 永久密钥
- 普通用户 → V2 订阅密钥
- 试用用户 → V2 短期密钥

---

## 🚀 快速开始

### 第一步：环境准备
```bash
cd tools
pip install -r requirements.txt
```

### 第二步：加密EXE文件
```bash
python encrypt_exe.py
# 输入您的EXE文件路径
# 生成：program_encrypted.dat + program_master.key
```

### 第三步：生成密钥

**V1 - 永久密钥：**
```bash
python generate_keys.py
# 生成永久有效的密钥
```

**V2 - 时效性密钥：**
```bash
python generate_keys_v2.py
# 选择有效期：1天/7天/30天/90天/365天/永久
```

### 第四步：上传到云盘
- 上传加密文件到阿里云OSS/蓝奏云/百度网盘
- 获取直链地址

### 第五步：配置下载脚本
```bash
# 编辑 dist/download.bat
# 修改第17行的云盘直链地址
```

### 第六步：编译启动器
```bash
cd dist

# V1启动器
pyinstaller --onefile --windowed --name=launcher launcher.py

# V2启动器（支持时效性）
pyinstaller --onefile --windowed --name=launcher_v2 launcher_v2.py
```

### 第七步：打包分发
```
用户安装包/
├── download.bat
├── launcher.exe (或 launcher_v2.exe)
└── 使用说明.txt
```

---

## 🔐 安全特性

### 一人一码机制
```
每个用户的密钥 = SHA256(主密钥 + 用户ID + 随机盐 + 时间戳)
```
- 每个用户独立密钥
- 无法从一个密钥推导其他密钥
- 可追踪使用情况
- 可单独撤销权限

### AES-256加密
- 算法：AES-256-CBC
- 密钥长度：256位
- 模式：CBC + PKCS7填充
- PE头验证

### 本地验证
- 无需联网验证
- 防止中间人攻击
- 保护用户隐私
- 解密后临时运行

---

## ⏰ 时效性验证原理（V2）

### 工作流程
```
密钥生成：
主密钥 + 用户ID + 有效期(30天) + 随机盐
    ↓ SHA256
64位密钥（60位哈希 + 4位有效期指纹）

首次使用：
记录激活时间 → 计算过期时间 → 保存到 activation.dat

每次启动：
读取激活记录 → 检查是否过期
├─ 未过期 → 显示"还剩X天" → 允许启动
└─ 已过期 → 显示"已过期" → 拒绝启动
```

### 用户体验
```
第1次使用：
"✅ 首次激活成功！有效期 30 天"

日常使用：
"✅ 密钥有效，还剩 25 天"

有效期不足（≤7天）：
"⚠️ 密钥有效，还剩 5 天"
+ 弹窗提醒续费

密钥过期：
"❌ 密钥已过期"
→ 拒绝启动
```

---

## 💼 商业应用场景

### 1. SaaS订阅软件
```
定价策略：
- 试用版：免费 7天
- 月度版：¥49/月
- 年度版：¥399/年（省33%）

实现方式：
使用V2版本，有效期分别设置为7天、30天、365天
```

### 2. 在线教育平台
```
课程授权：
- 单月课程：¥99（30天）
- 季度课程：¥249（90天）
- 年度课程：¥799（365天）

实现方式：
使用V2版本，根据购买套餐生成对应有效期的密钥
```

### 3. 游戏会员系统
```
会员卡类型：
- 周卡：¥19（7天）
- 月卡：¥49（30天）
- 季卡：¥129（90天）

实现方式：
使用V2版本，支持多次充值续期
```

### 4. 企业内部工具
```
员工授权：
- 实习生：90天试用期（V2）
- 外包人员：30天项目期（V2）
- 正式员工：365天或永久（V2/V1）

实现方式：
混合使用V1和V2，灵活管理权限
```

---

## 📚 文档说明

### 核心文档
- **README.md** (12KB) - 完整技术文档，包含所有功能的详细说明
- **快速入门.md** (2.8KB) - 5分钟快速上手指南
- **项目概览.md** (本文档) - 项目全貌和关键信息

### V2专属文档
- **时效性验证说明.md** (11KB) - V2版本详细使用指南
- **版本选择指南.md** (7.5KB) - V1/V2对比和选择建议

### 演示程序
- **DEMO.py** - V1功能完整演示
- **DEMO_V2.py** - V2功能完整演示（包含时效性验证）

---

## 🛠️ 常用命令

### 查看演示
```bash
python DEMO.py          # V1基础版演示
python DEMO_V2.py       # V2时效性版演示
```

### 管理密钥
```bash
# V1 - 生成永久密钥
cd tools
python generate_keys.py

# V2 - 生成时效性密钥
python generate_keys_v2.py
```

### 加密文件
```bash
cd tools
python encrypt_exe.py
```

### 编译启动器
```bash
cd dist
# V1启动器
pyinstaller --onefile --windowed --name=launcher launcher.py

# V2启动器
pyinstaller --onefile --windowed --name=launcher_v2 launcher_v2.py
```

---

## ❓ 常见问题

### Q: V1和V2可以同时使用吗？
**A:** 可以！两个版本完全独立，可以根据不同用户需求混合使用。

### Q: 如何选择合适的版本？
**A:**
- 需要永久授权 → V1
- 需要试用版/订阅制 → V2
- 不确定 → 推荐V2（更灵活）

详细对比请查看：`版本选择指南.md`

### Q: 如何实现试用转付费？
**A:**
1. 先发放V2版本的7天试用密钥
2. 试用满意后，生成30天/365天的正式密钥
3. 或者使用"延长有效期"功能续期

### Q: 密钥过期后如何续费？
**A:**
方式1：使用`generate_keys_v2.py`的"延长有效期"功能
方式2：重新生成新的密钥发给用户

### Q: 如何防止密钥被多人共用？
**A:**
可以在launcher中添加：
- 硬件绑定（绑定机器码）
- 在线验证（限制同时在线数）
- 使用次数限制

详见：`时效性验证说明.md` - 安全性增强章节

### Q: 云盘推荐哪个？
**A:**
- 推荐：阿里云OSS（稳定、快速、可控）
- 备选：蓝奏云（免费、有直链）
- 备选：百度网盘（需转换直链）

---

## 🔄 版本更新记录

### V2.0（2025-12-25）⭐ 新增
- ✅ 时效性验证功能
- ✅ 首次激活机制
- ✅ 过期检测和提醒
- ✅ 密钥续期功能
- ✅ 多种有效期预设（1天~永久）

### V1.0（2025-12-25）
- ✅ EXE文件加密
- ✅ 一人一码密钥系统
- ✅ 云盘直链下载
- ✅ BAT自动下载脚本
- ✅ 图形化启动器
- ✅ 本地密钥验证

---

## 📞 获取帮助

### 查看文档
```bash
cat README.md              # 完整文档
cat 快速入门.md            # 快速上手
cat 时效性验证说明.md      # V2详细说明
cat 版本选择指南.md        # 版本对比
```

### 运行演示
```bash
python DEMO.py             # V1演示
python DEMO_V2.py          # V2演示
```

### 技术支持
- 详细的中文文档
- 完整的代码示例
- 实际应用场景演示

---

## ✅ 系统优势

### 技术优势
- 🔐 军事级AES-256加密
- 🔑 SHA256密钥生成算法
- 💾 本地验证，保护隐私
- 🎯 一人一码，精准控制
- ⏰ 时效性验证（V2）

### 商业优势
- 💰 支持多种商业模式（买断/订阅）
- 📊 灵活的授权策略
- 🚀 易于部署和分发
- 👥 用户体验友好
- 📈 可扩展性强

### 管理优势
- 🛠️ 图形化管理工具
- 📋 密钥数据库管理
- 🔄 支持批量生成
- 📤 一键导出清单
- ⏱️ 实时状态查看（V2）

---

## 🎯 总结

本项目提供了完整的EXE文件加密分发解决方案：

✅ **两个版本**：V1永久授权 + V2时效性验证
✅ **完整工具链**：加密→生成密钥→分发→验证
✅ **安全可靠**：AES-256 + 一人一码 + 本地验证
✅ **易于使用**：图形化界面 + 自动化脚本
✅ **灵活部署**：支持多种云盘平台
✅ **详细文档**：14个文档和演示文件

**适用场景：**
- 商业软件授权分发
- 在线教育课程管理
- 企业内部工具部署
- 游戏会员系统
- SaaS订阅服务

**立即开始：**
```bash
python DEMO_V2.py          # 查看完整演示
cd tools
pip install -r requirements.txt
python encrypt_exe.py      # 加密您的程序
```

---

**版本：** v2.0
**更新日期：** 2025-12-25
**作者：** Claude AI
**特性：** 支持永久授权 + 时效性验证
